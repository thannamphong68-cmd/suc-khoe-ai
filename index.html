<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Healthyai Pro v3.0 - Future Health OS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700;800&display=swap');
        :root { --primary: #3b82f6; --bg: #020617; --card: rgba(15, 23, 42, 0.7); --text: #f8fafc; }
        .light-mode { --primary: #2563eb; --bg: #f1f5f9; --card: rgba(255, 255, 255, 0.8); --text: #0f172a; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: var(--bg); color: var(--text); transition: 0.4s; overflow-x: hidden; padding-bottom: 80px; }
        .glass { border: 1px solid rgba(255,255,255,0.1); backdrop-filter: blur(16px); background: var(--card); }
        .tab-btn.active { background: #3b82f6; color: white; transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(59, 130, 246, 0.4); }
        #splash-screen { position: fixed; inset: 0; z-index: 1000; background: #020617; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: 0.8s opacity ease; }
        .water-wave { position: relative; overflow: hidden; background: rgba(59, 130, 246, 0.1); }
        .water-wave::after { content: ''; position: absolute; bottom: 0; left: 0; width: 100%; height: var(--p, 0%); background: #3b82f6; transition: 1s cubic-bezier(0.4, 0, 0.2, 1); opacity: 0.6; }
    </style>
</head>
<body class="dark-mode">

    <div id="splash-screen">
        <div class="text-center space-y-4">
            <div class="w-16 h-16 bg-blue-600 rounded-2xl mx-auto flex items-center justify-center animate-bounce shadow-2xl shadow-blue-500/50">
                <i data-lucide="activity" class="text-white w-8 h-8"></i>
            </div>
            <p id="proverb" class="text-blue-300 italic text-sm px-6 transition-opacity opacity-0"></p>
            <div class="w-32 h-1 bg-white/10 mx-auto rounded-full overflow-hidden">
                <div id="loader" class="h-full bg-blue-500 w-0 transition-all duration-[1500ms]"></div>
            </div>
        </div>
    </div>

    <nav class="max-w-7xl mx-auto flex justify-between items-center p-6 sticky top-0 z-50 bg-slate-950/20 backdrop-blur-md border-b border-white/5">
        <div class="flex items-center gap-3">
            <div class="p-2 bg-blue-600 rounded-lg"><i data-lucide="zap" class="text-white w-5 h-5"></i></div>
            <h1 class="text-lg font-black tracking-tighter">HEALTHYAI <span class="text-blue-500 text-xs">OS 3.0</span></h1>
        </div>
        <div class="flex gap-2">
            <button onclick="toggleTheme()" class="p-2 bg-white/5 rounded-lg border border-white/10"><i data-lucide="sun" id="theme-icon"></i></button>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto p-4 grid grid-cols-1 lg:grid-cols-12 gap-6">
        
        <div class="lg:col-span-4 space-y-6">
            <div class="glass p-6 rounded-[2rem] border-t-2 border-blue-500">
                <h3 class="text-[10px] font-black uppercase opacity-40 mb-4 tracking-widest flex items-center gap-2">
                    <i data-lucide="fingerprint" class="w-4 h-4"></i> Hồ sơ sinh học
                </h3>
                <div class="space-y-3">
                    <input type="text" id="name" placeholder="Họ và tên" class="w-full bg-black/20 border border-white/5 rounded-xl p-3 text-sm outline-none">
                    <div class="grid grid-cols-2 gap-3">
                        <input type="number" id="age" placeholder="Tuổi" class="bg-black/20 border border-white/5 rounded-xl p-3 text-sm outline-none">
                        <select id="gender" class="bg-black/20 border border-white/5 rounded-xl p-3 text-sm outline-none">
                            <option value="male">Nam</option>
                            <option value="female">Nữ</option>
                        </select>
                    </div>
                    <div class="grid grid-cols-2 gap-3">
                        <input type="number" id="weight" placeholder="Kg" class="bg-black/20 border border-white/5 rounded-xl p-3 text-sm outline-none">
                        <input type="number" id="height" placeholder="Cm" class="bg-black/20 border border-white/5 rounded-xl p-3 text-sm outline-none">
                    </div>
                    <button onclick="processData()" class="w-full bg-blue-600 py-3 rounded-xl font-bold text-xs uppercase shadow-lg shadow-blue-500/20 transition hover:bg-blue-500">Cập nhật chỉ số</button>
                </div>
            </div>

            <div class="glass p-6 rounded-[2rem] water-wave" id="water-card">
                <div class="relative z-10 flex items-center justify-between">
                    <div>
                        <h4 class="text-xs font-black uppercase opacity-60">Nước uống</h4>
                        <div class="text-2xl font-black mt-1"><span id="water-count">0</span>/2500<span class="text-xs ml-1">ml</span></div>
                    </div>
                    <button onclick="addWater()" class="w-12 h-12 bg-blue-500 rounded-full flex items-center justify-center shadow-lg hover:scale-110 transition active:scale-90">
                        <i data-lucide="plus" class="text-white"></i>
                    </button>
                </div>
            </div>

            <div class="glass p-6 rounded-[2rem]">
                <h4 class="text-[10px] font-black uppercase opacity-40 mb-4">Dự đoán triệu chứng</h4>
                <div class="space-y-2">
                    <select id="symptom-select" class="w-full bg-black/20 border border-white/5 rounded-xl p-3 text-sm outline-none">
                        <option value="">Chọn triệu chứng cơ bản...</option>
                        <option value="headache">Đau đầu, chóng mặt</option>
                        <option value="fever">Sốt, nóng người</option>
                        <option value="cough">Ho, đau họng</option>
                        <option value="stomach">Đau bụng, khó tiêu</option>
                        <option value="fatigue">Mệt mỏi, uể oải</option>
                    </select>
                    <button onclick="checkSymptoms()" class="w-full bg-emerald-600/20 text-emerald-500 border border-emerald-500/20 py-2 rounded-xl text-[10px] font-bold uppercase hover:bg-emerald-600 hover:text-white transition">Chẩn đoán nhanh</button>
                </div>
            </div>
        </div>

        <div class="lg:col-span-8 space-y-6">
            
            <div id="tab-dashboard" class="tab-content space-y-6">
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <div class="glass p-5 rounded-3xl border-b-4 border-blue-500">
                        <p class="text-[10px] font-bold opacity-40 uppercase">BMI</p>
                        <div id="res-bmi" class="text-2xl font-black">--</div>
                    </div>
                    <div class="glass p-5 rounded-3xl border-b-4 border-emerald-500">
                        <p class="text-[10px] font-bold opacity-40 uppercase">Calo/Ngày</p>
                        <div id="res-tdee" class="text-2xl font-black">--</div>
                    </div>
                    <div class="glass p-5 rounded-3xl border-b-4 border-orange-500">
                        <p class="text-[10px] font-bold opacity-40 uppercase">Nước/Ngày</p>
                        <div id="res-water-target" class="text-2xl font-black">--</div>
                    </div>
                    <div class="glass p-5 rounded-3xl border-b-4 border-purple-500">
                        <p class="text-[10px] font-bold opacity-40 uppercase">Tình trạng</p>
                        <div id="res-status" class="text-[10px] font-black text-blue-400 mt-2 uppercase italic leading-tight">Chờ dữ liệu...</div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="glass p-6 rounded-[2.5rem]">
                        <canvas id="radarChart" class="max-h-60"></canvas>
                    </div>
                    <div class="glass p-6 rounded-[2.5rem]">
                        <div class="flex justify-between items-center mb-4">
                            <h4 class="text-[10px] font-black uppercase opacity-40">Lịch sử đo</h4>
                            <button onclick="clearHistory()" class="text-[8px] text-red-500 font-black uppercase">Xóa hết</button>
                        </div>
                        <div id="history-box" class="space-y-3 max-h-48 overflow-y-auto pr-2 custom-scrollbar"></div>
                    </div>
                </div>
            </div>

            <div id="tab-symptoms" class="tab-content hidden glass p-8 rounded-[2.5rem]">
                <h3 class="text-xl font-black mb-6 flex items-center gap-3"><i data-lucide="stethoscope" class="text-emerald-500"></i> AI Symptom Diagnostic</h3>
                <div id="diagnosis-result" class="space-y-6">
                    <div class="p-10 border-2 border-dashed border-white/5 rounded-3xl text-center opacity-30 italic">Vui lòng chọn triệu chứng ở menu bên trái để bắt đầu phân tích.</div>
                </div>
            </div>

            <div id="tab-diet" class="tab-content hidden glass p-8 rounded-[2.5rem]">
                <div class="flex flex-col md:flex-row gap-8">
                    <div class="flex-1 space-y-4">
                        <h4 class="font-black text-xs uppercase opacity-40">Thêm bữa ăn</h4>
                        <input type="text" id="food-input" placeholder="Tên món ăn" class="w-full bg-white/5 rounded-xl p-3 outline-none">
                        <input type="number" id="cal-input" placeholder="Calories" class="w-full bg-white/5 rounded-xl p-3 outline-none">
                        <button onclick="addFood()" class="w-full bg-blue-600 py-3 rounded-xl font-bold">Lưu bữa ăn</button>
                    </div>
                    <div class="flex-1 bg-black/20 rounded-3xl p-6">
                        <div class="text-center mb-4">
                            <p class="text-[10px] opacity-40">TỔNG CALO HÔM NAY</p>
                            <h2 id="consumed-cal" class="text-4xl font-black text-blue-500">0</h2>
                        </div>
                        <div id="diet-log" class="space-y-2 max-h-40 overflow-y-auto"></div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <div class="fixed bottom-4 left-1/2 -translate-x-1/2 w-[90%] max-w-md glass p-2 rounded-2xl z-[100] flex justify-between items-center shadow-2xl border border-white/10">
        <button onclick="switchTab('dashboard')" class="tab-btn active flex-1 py-3 rounded-xl flex flex-col items-center gap-1">
            <i data-lucide="layout-dashboard" class="w-5 h-5"></i><span class="text-[8px] font-bold uppercase">Dashboard</span>
        </button>
        <button onclick="switchTab('diet')" class="tab-btn flex-1 py-3 rounded-xl flex flex-col items-center gap-1">
            <i data-lucide="utensils" class="w-5 h-5"></i><span class="text-[8px] font-bold uppercase">Ăn uống</span>
        </button>
        <button onclick="switchTab('symptoms')" class="tab-btn flex-1 py-3 rounded-xl flex flex-col items-center gap-1">
            <i data-lucide="activity" class="w-5 h-5"></i><span class="text-[8px] font-bold uppercase">AI Chẩn đoán</span>
        </button>
    </div>

    <script>
        const proverbs = ["Sức khỏe là vàng.", "Ăn được ngủ được là tiên.", "Đau bụng lấy tay mà rờ.", "Cơm là bản, cá là vây."];
        let logs = JSON.parse(localStorage.getItem('healthy_v3_logs')) || [];
        let radar;
        let waterDrank = 0;

        // INIT
        window.onload = () => {
            lucide.createIcons();
            const p = document.getElementById('proverb');
            p.innerText = `"${proverbs[Math.floor(Math.random()*proverbs.length)]}"`;
            setTimeout(() => p.style.opacity = '1', 200);
            setTimeout(() => {
                document.getElementById('loader').style.width = '100%';
            }, 100);
            setTimeout(() => {
                document.getElementById('splash-screen').style.opacity = '0';
                setTimeout(() => document.getElementById('splash-screen').style.display = 'none', 800);
            }, 2000);

            initChart();
            renderHistory();
        };

        function switchTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.add('hidden'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(`tab-${tabId}`).classList.remove('hidden');
            event.currentTarget.classList.add('active');
        }

        function toggleTheme() {
            document.body.classList.toggle('light-mode');
            const isL = document.body.classList.contains('light-mode');
            document.getElementById('theme-icon').setAttribute('data-lucide', isL ? 'moon' : 'sun');
            lucide.createIcons();
        }

        // --- HEALTH LOGIC ---
        function processData() {
            const w = parseFloat(document.getElementById('weight').value);
            const h = parseFloat(document.getElementById('height').value);
            const a = parseInt(document.getElementById('age').value);
            const name = document.getElementById('name').value || "Người dùng";

            if(!w || !h || !a) return;

            const bmi = (w / ((h/100)**2)).toFixed(1);
            const tdee = Math.round((10 * w + 6.25 * h - 5 * a + 5) * 1.2);
            const water = Math.round(w * 35);

            document.getElementById('res-bmi').innerText = bmi;
            document.getElementById('res-tdee').innerText = tdee;
            document.getElementById('res-water-target').innerText = water;

            let status = "";
            if(bmi < 18.5) status = "Thiếu cân - Cần tăng cường dinh dưỡng";
            else if(bmi < 24.9) status = "Bình thường - Trạng thái rất tốt";
            else status = "Thừa cân - Cần kiểm soát vận động";
            document.getElementById('res-status').innerText = status;

            updateChart(bmi);
            saveLog(name, bmi);
        }

        function addWater() {
            waterDrank += 250;
            const target = parseInt(document.getElementById('res-water-target').innerText) || 2500;
            document.getElementById('water-count').innerText = waterDrank;
            const percent = Math.min(100, (waterDrank / target) * 100);
            document.getElementById('water-card').style.setProperty('--p', percent + '%');
        }

        // --- SYMPTOM CHECKER ---
        const symptomData = {
            headache: { title: "Cảm cúm hoặc Thiếu ngủ", advice: "Hãy uống nước ấm, nghỉ ngơi 30 phút. Nếu kèm sốt cao cần gặp bác sĩ.", foods: "Trà gừng, cháo loãng" },
            fever: { title: "Sốt siêu vi / Nhiễm khuẩn", advice: "Lau mát bằng nước ấm, theo dõi nhiệt độ mỗi 4h. Tránh gió lạnh.", foods: "Nước cam, cháo thịt bằm" },
            cough: { title: "Viêm họng / Viêm phế quản", advice: "Súc miệng nước muối, giữ ấm cổ. Hạn chế uống nước đá.", foods: "Mật ong, lê chưng" },
            stomach: { title: "Rối loạn tiêu hóa", advice: "Tránh thức ăn dầu mỡ, cay nóng. Có thể dùng gừng tươi.", foods: "Sữa chua, chuối, bánh mì" },
            fatigue: { title: "Suy nhược cơ thể", advice: "Bổ sung Vitamin nhóm B, ngủ đủ 8 tiếng. Kiểm tra áp lực công việc.", foods: "Các loại hạt, trứng, rau xanh" }
        };

        function checkSymptoms() {
            const sym = document.getElementById('symptom-select').value;
            if(!sym) return alert("Vui lòng chọn 1 triệu chứng!");
            
            switchTab('symptoms');
            const res = symptomData[sym];
            document.getElementById('diagnosis-result').innerHTML = `
                <div class="animate-in slide-in-from-bottom duration-500 space-y-4">
                    <div class="p-6 bg-blue-500/10 border border-blue-500/20 rounded-3xl">
                        <span class="text-[10px] font-black text-blue-400 uppercase tracking-tighter">AI Dự đoán có thể là</span>
                        <h4 class="text-2xl font-black">${res.title}</h4>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="p-5 bg-white/5 rounded-2xl">
                            <h5 class="text-xs font-bold mb-2 flex items-center gap-2 text-emerald-500"><i data-lucide="check-circle" class="w-4 h-4"></i> Khuyên dùng</h5>
                            <p class="text-xs opacity-70">${res.advice}</p>
                        </div>
                        <div class="p-5 bg-white/5 rounded-2xl">
                            <h5 class="text-xs font-bold mb-2 flex items-center gap-2 text-orange-500"><i data-lucide="soup" class="w-4 h-4"></i> Món ăn hỗ trợ</h5>
                            <p class="text-xs opacity-70">${res.foods}</p>
                        </div>
                    </div>
                    <p class="text-[8px] opacity-30 italic">* Lưu ý: Đây là dự đoán từ AI, không thay thế chẩn đoán y khoa chuyên nghiệp.</p>
                </div>
            `;
            lucide.createIcons();
        }

        // --- UTILS ---
        function saveLog(name, bmi) {
            const time = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            logs.unshift({name, bmi, time});
            if(logs.length > 5) logs.pop();
            localStorage.setItem('healthy_v3_logs', JSON.stringify(logs));
            renderHistory();
        }

        function renderHistory() {
            const box = document.getElementById('history-box');
            if(logs.length === 0) return;
            box.innerHTML = logs.map(l => `
                <div class="flex justify-between items-center p-3 bg-white/5 rounded-xl border border-white/5">
                    <div><p class="text-[10px] font-bold">${l.name}</p><p class="text-[8px] opacity-40">${l.time}</p></div>
                    <div class="text-lg font-black text-blue-500">${l.bmi}</div>
                </div>
            `).join('');
        }

        function clearHistory() {
            if(confirm("Xóa lịch sử?")) {
                logs = [];
                localStorage.removeItem('healthy_v3_logs');
                renderHistory();
            }
        }

        function initChart() {
            const ctx = document.getElementById('radarChart').getContext('2d');
            radar = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['BMI', 'Nước', 'Ăn uống', 'Vận động', 'Ngủ'],
                    datasets: [{
                        data: [0,0,0,0,0],
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.2)',
                        borderWidth: 2,
                        pointRadius: 0
                    }]
                },
                options: { 
                    scales: { r: { grid: { color: 'rgba(255,255,255,0.05)' }, angleLines: { color: 'rgba(255,255,255,0.1)' }, ticks: { display: false } } },
                    plugins: { legend: { display: false } }
                }
            });
        }

        function updateChart(bmi) {
            radar.data.datasets[0].data = [bmi, 70, 60, 80, 50];
            radar.update();
        }

        function addFood() {
            const f = document.getElementById('food-input').value;
            const c = parseInt(document.getElementById('cal-input').value);
            if(!f || !c) return;
            const log = document.getElementById('diet-log');
            const div = document.createElement('div');
            div.className = "flex justify-between text-[10px] p-2 bg-white/5 rounded-lg";
            div.innerHTML = `<span>${f}</span><span class="font-bold text-blue-400">+${c}</span>`;
            log.prepend(div);
            let current = parseInt(document.getElementById('consumed-cal').innerText);
            document.getElementById('consumed-cal').innerText = current + c;
            document.getElementById('food-input').value = "";
            document.getElementById('cal-input').value = "";
        }
    </script>
</body>
</html>
