<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Healthyai - Thân Nam Phong</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700;800&display=swap');
        
        :root { --bg: #030712; --card: rgba(17, 24, 39, 0.8); --text: #f8fafc; --border: rgba(255,255,255,0.1); }
        .light-mode { --bg: #f8fafc; --card: rgba(255, 255, 255, 0.9); --text: #0f172a; --border: rgba(0,0,0,0.1); }

        body { font-family: 'Plus Jakarta Sans', sans-serif; background: var(--bg); color: var(--text); transition: background 0.4s ease; min-height: 100vh; }
        
        .mesh-bg {
            position: fixed; inset: 0; z-index: -1;
            background: radial-gradient(circle at 0% 0%, #1e3a8a 0%, transparent 40%),
                        radial-gradient(circle at 100% 100%, #4c1d95 0%, transparent 40%);
            opacity: 0.3; filter: blur(60px);
        }

        .glass { background: var(--card); backdrop-filter: blur(20px); border: 1px solid var(--border); }
        
        #intro-screen { position: fixed; inset: 0; background: #020617; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: 1s ease; }
        #about-modal { display: none; position: fixed; inset: 0; z-index: 1000; background: rgba(0,0,0,0.8); backdrop-filter: blur(15px); align-items: center; justify-content: center; }
        #about-modal.active { display: flex; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="dark-mode">
    <div class="mesh-bg"></div>

    <div id="intro-screen">
        <div class="w-20 h-20 bg-blue-600 rounded-3xl flex items-center justify-center animate-pulse shadow-2xl">
            <i data-lucide="sparkles" class="text-white w-10 h-10"></i>
        </div>
        <h2 class="mt-8 text-2xl font-black tracking-tight text-white uppercase">HEALTHYAI</h2>
        <p id="intro-quote" class="mt-4 text-slate-400 italic text-sm text-center px-10"></p>
    </div>

    <div id="about-modal" onclick="this.classList.remove('active')">
        <div class="glass p-10 rounded-[3rem] max-w-2xl w-full m-4 relative" onclick="event.stopPropagation()">
            <div class="flex items-center gap-4 mb-6">
                <div class="w-14 h-14 bg-blue-600 rounded-2xl flex items-center justify-center shadow-lg"><i data-lucide="user" class="text-white"></i></div>
                <div>
                    <h3 class="text-xl font-black">Thân Nam Phong</h3>
                    <p class="text-blue-500 text-[10px] font-bold uppercase tracking-widest">Sáng lập dự án</p>
                </div>
            </div>
            <h4 class="text-blue-500 font-bold text-sm mb-2 uppercase">Giới thiệu Website</h4>
            <p class="opacity-70 text-sm leading-relaxed">
                Healthyai là một công cụ phân tích sức khỏe cá nhân, giúp người dùng theo dõi các chỉ số sinh học quan trọng. Website hỗ trợ phân tích đa dạng các giai đoạn phát triển của con người, từ Nhi đồng đến Cao niên, cung cấp các gợi ý về lối sống và dinh dưỡng khoa học.
            </p>
        </div>
    </div>

    <nav class="max-w-7xl mx-auto flex justify-between items-center p-8 relative z-10">
        <div class="flex items-center gap-3">
            <div onclick="document.getElementById('about-modal').classList.add('active')" class="w-10 h-10 bg-blue-600 rounded-xl flex items-center justify-center cursor-pointer shadow-lg hover:scale-110 transition">
                <i data-lucide="activity" class="text-white w-6 h-6"></i>
            </div>
            <h1 class="text-lg font-black tracking-tighter">HEALTHYAI</h1>
        </div>
        <div class="flex gap-4">
            <button onclick="document.getElementById('about-modal').classList.add('active')" class="text-[10px] font-black uppercase tracking-widest bg-white/5 px-6 py-3 rounded-full border border-white/10 hover:bg-white/10 transition hidden md:block">Về dự án</button>
            <button onclick="toggleTheme()" class="p-3 glass rounded-2xl shadow-lg border-blue-500/20"><i data-lucide="sun" id="theme-icon" class="text-blue-500"></i></button>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto p-4 grid grid-cols-1 lg:grid-cols-12 gap-8 relative z-10">
        <div class="lg:col-span-4 space-y-6">
            <div class="glass p-8 rounded-[3.5rem] border-t-2 border-blue-500">
                <h3 class="font-bold text-[10px] uppercase opacity-40 mb-6 tracking-widest">Thông tin gốc</h3>
                <div class="space-y-4">
                    <input type="text" id="name" placeholder="Họ tên" class="w-full bg-black/10 border border-white/10 rounded-2xl p-4 text-sm outline-none focus:border-blue-500 transition">
                    <div class="grid grid-cols-2 gap-4">
                        <select id="gender" class="bg-black/10 border border-white/10 rounded-2xl p-4 text-sm outline-none"><option value="male">Nam</option><option value="female">Nữ</option></select>
                        <input type="number" id="age" placeholder="Tuổi" class="w-full bg-black/10 border border-white/10 rounded-2xl p-4 text-sm outline-none">
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <input type="number" id="weight" placeholder="Cân nặng" class="w-full bg-black/10 border border-white/10 rounded-2xl p-4 text-sm outline-none">
                        <input type="number" id="height" placeholder="Chiều cao" class="w-full bg-black/10 border border-white/10 rounded-2xl p-4 text-sm outline-none">
                    </div>
                </div>
                <button onclick="processData()" class="w-full mt-8 bg-blue-600 hover:bg-blue-500 py-5 rounded-2xl font-black text-[10px] uppercase tracking-widest text-white shadow-xl shadow-blue-600/20 transition-all active:scale-95">Phân tích ngay</button>
            </div>
        </div>

        <div id="report-area" class="lg:col-span-8 space-y-6">
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <div class="glass p-6 rounded-3xl text-center">
                    <p class="text-[10px] font-bold opacity-30 mb-2 uppercase">BMI</p>
                    <div id="res-bmi" class="text-3xl font-black">--</div>
                </div>
                <div class="glass p-6 rounded-3xl text-center">
                    <p class="text-[10px] font-bold opacity-30 mb-2 uppercase">Giai đoạn</p>
                    <div id="res-stage" class="text-xs font-black text-blue-500 mt-2">--</div>
                </div>
                <div class="glass p-6 rounded-3xl text-center">
                    <p class="text-[10px] font-bold opacity-30 mb-2 uppercase">Nước/Ngày</p>
                    <div id="res-water" class="text-3xl font-black">--</div>
                </div>
                <div class="glass p-6 rounded-3xl text-center border-b-4 border-blue-500">
                    <p class="text-[10px] font-bold opacity-30 mb-2 uppercase">Mỡ cơ thể</p>
                    <div id="res-fat" class="text-3xl font-black">--</div>
                </div>
            </div>

            <div id="analysis-box" class="glass p-8 rounded-[2.5rem] hidden border-l-4 border-blue-500">
                <h4 class="text-blue-500 font-bold text-sm mb-2 uppercase tracking-tight">Phân tích sức khỏe</h4>
                <p id="analysis-text" class="text-sm opacity-80 leading-relaxed italic"></p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="glass p-6 rounded-[2.5rem] h-64"><canvas id="radarChart"></canvas></div>
                <div class="glass p-6 rounded-[2.5rem] h-64"><canvas id="lineChart"></canvas></div>
            </div>

            <div class="glass p-6 rounded-[2.5rem]">
                <div class="flex justify-between items-center mb-4 px-2">
                    <h4 class="text-[10px] font-bold uppercase opacity-30 tracking-widest">Biến động BMI</h4>
                    <p id="ca-dao-text" class="text-[10px] italic text-blue-500"></p>
                </div>
                <div id="history-box" class="flex gap-4 overflow-x-auto pb-2 no-scrollbar"></div>
            </div>
        </div>
    </main>

    <script>
        lucide.createIcons();
        const caDaos = [
            "Muốn cho thân thể bình yên - Ăn uống điều độ, ngủ yên đúng giờ.",
            "Ăn được ngủ được là tiên - Không ăn không ngủ mất tiền thêm lo.",
            "Cơm là bản, cá là vây - Muốn cho khỏe mạnh thì hay ăn rau."
        ];
        
        let logs = JSON.parse(localStorage.getItem('healthy_logs')) || [];
        let radar, line;

        // Intro
        document.getElementById('intro-quote').innerText = caDaos[Math.floor(Math.random()*caDaos.length)];
        setTimeout(() => {
            const intro = document.getElementById('intro-screen');
            intro.style.opacity = '0';
            setTimeout(() => intro.style.display = 'none', 1000);
        }, 2000);

        function toggleTheme() {
            const b = document.body;
            b.classList.toggle('light-mode');
            const icon = document.getElementById('theme-icon');
            const isLight = b.classList.contains('light-mode');
            icon.setAttribute('data-lucide', isLight ? 'moon' : 'sun');
            lucide.createIcons();
        }

        function initCharts() {
            const radarCtx = document.getElementById('radarChart');
            const lineCtx = document.getElementById('lineChart');

            radar = new Chart(radarCtx, {
                type: 'radar',
                data: {
                    labels: ['BMI', 'Nước', 'Vận động', 'Protein', 'Sức mạnh'],
                    datasets: [{ data: [0,0,0,0,0], borderColor: '#3b82f6', backgroundColor: 'rgba(59,130,246,0.1)', borderWidth: 2 }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { r: { grid: { color: 'rgba(150,150,150,0.1)' }, ticks: { display: false } } } }
            });

            line = new Chart(lineCtx, {
                type: 'line',
                data: {
                    labels: logs.map(l => l.t),
                    datasets: [{ label: 'BMI', data: logs.map(l => l.b), borderColor: '#818cf8', tension: 0.4, fill: true, backgroundColor: 'rgba(129,140,248,0.1)', pointBackgroundColor: '#818cf8' }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { display: false }, y: { display: false } } }
            });
            renderHistory();
        }

        function getLifeStage(age) {
            if (age <= 12) return { l: "NHI ĐỒNG", c: "text-blue-500", tip: "Đang tuổi lớn, hãy bổ sung Canxi và bơi lội thường xuyên để phát triển khung xương." };
            if (age <= 19) return { l: "DẬY THÌ", c: "text-pink-500", tip: "Hormone đang thay đổi mạnh, ưu tiên ngủ sớm trước 22h và tập các bài tập kéo giãn chiều cao." };
            if (age <= 35) return { l: "TRƯỞNG THÀNH", c: "text-emerald-500", tip: "Thời điểm vàng để xây dựng cơ bắp. Hãy duy trì tập kháng lực 3-4 buổi/tuần." };
            if (age <= 55) return { l: "TRUNG NIÊN", c: "text-orange-500", tip: "Trao đổi chất bắt đầu chậm lại, cần kiểm soát lượng tinh bột và tăng cường thực phẩm giàu chất xơ." };
            return { l: "CAO NIÊN", c: "text-purple-500", tip: "Ưu tiên các bài tập dẻo dai như Yoga, đi bộ và bổ sung thực phẩm giàu Omega-3 cho trí não." };
        }

        function processData() {
            const w = parseFloat(document.getElementById('weight').value);
            const h = parseFloat(document.getElementById('height').value);
            const age = parseInt(document.getElementById('age').value);
            const name = document.getElementById('name').value || "Bạn";
            const g = document.getElementById('gender').value;

            if(!w || !h || !age) return;

            const bmi = (w / ((h/100)**2)).toFixed(1);
            const water = (w * 0.035).toFixed(1);
            const bf = Math.abs((1.2 * bmi) + (0.23 * age) - (g === 'male' ? 16.2 : 5.4)).toFixed(1);
            const stage = getLifeStage(age);

            // Update UI
            document.getElementById('res-bmi').innerText = bmi;
            document.getElementById('res-water').innerText = water;
            document.getElementById('res-fat').innerText = bf + "%";
            document.getElementById('res-stage').innerText = stage.l;
            document.getElementById('res-stage').className = `text-xs font-black mt-2 ${stage.c}`;
            
            document.getElementById('analysis-box').classList.remove('hidden');
            document.getElementById('analysis-text').innerText = `${name} ơi, ở giai đoạn ${stage.l}, chỉ số BMI ${bmi} cho thấy bạn cần lưu ý: ${stage.tip}`;

            // Update Radar Chart
            radar.data.datasets[0].data = [bmi, water * 10, 65, 70, 80];
            radar.update();

            // Save and Update Line Chart
            const time = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            logs.push({ t: time, b: bmi, n: name });
            if(logs.length > 7) logs.shift();
            localStorage.setItem('healthy_logs', JSON.stringify(logs));
            
            line.data.labels = logs.map(l => l.t);
            line.data.datasets[0].data = logs.map(l => l.b);
            line.update();
            
            renderHistory();
        }

        function renderHistory() {
            const box = document.getElementById('history-box');
            document.getElementById('ca-dao-text').innerText = caDaos[Math.floor(Math.random()*caDaos.length)];
            box.innerHTML = logs.slice().reverse().map(l => `
                <div class="flex-shrink-0 p-5 glass rounded-3xl min-w-[130px] text-center border-blue-500/10">
                    <p class="text-[8px] font-bold opacity-30 uppercase">${l.t}</p>
                    <p class="text-xs font-bold text-blue-500 truncate">${l.n}</p>
                    <p class="text-xl font-black mt-1">${l.b}</p>
                </div>
            `).join('');
        }

        window.onload = initCharts;
    </script>
</body>
</html>
